version: "3.1"

rules:
- rule: Chào hỏi người dùng
  steps:
  - intent: greet
  - action: utter_greet

- rule: Tạm biệt người dùng
  steps:
  - intent: goodbye
  - action: utter_goodbye

- rule: Khẳng định
  steps:
  - intent: affirm
  - action: utter_affirm

- rule: Phủ định
  steps:
  - intent: deny
  - action: utter_deny

- rule: Tâm trạng vui
  steps:
  - intent: mood_great
  - action: utter_mood_great

- rule: Tâm trạng buồn
  steps:
  - intent: mood_unhappy
  - action: utter_mood_unhappy

- rule: Kiểm tra bot
  steps:
  - intent: bot_challenge
  - action: utter_bot_challenge
- rule: Hỏi về sáp nhập tỉnh mới
  steps:
  - intent: ask_new_province
  - action: action_query_knowledge_base
  - action: utter_new_province_info

- rule: Hỏi mẹo du lịch
  steps:
  - intent: ask_travel_tips
  - action: action_query_knowledge_base
  - action: utter_travel_tips_info

- rule: Hỏi phương tiện di chuyển
  steps:
  - intent: ask_transportation
  - action: action_query_knowledge_base
  - action: utter_transportation_info

- rule: Hỏi lễ hội với thời gian
  condition:
  - slot_was_set:
      - time: true
  steps:
  - intent: ask_festival
  - action: action_query_knowledge_base
  - action: utter_festival_info
- rule: Xử lý câu hỏi ngoài phạm vi
  steps:
  - intent: out_of_scope
  - action: utter_out_of_scope

- rule: Fallback khi bot không chắc chắn
  steps:
  - action: action_default_fallback
  - action: utter_out_of_scope

# rules.yml (Bổ sung thêm vào file hiện tại của bạn)

- rule: Hỏi ẩm thực (có địa điểm)
  condition:
  - slot_was_set:
    - location: true # Nếu slot location đã được set
  steps:
  - intent: ask_cuisine
  - action: action_query_knowledge_base
  - action: utter_cuisine_info       # ✅ Sử dụng utter_cuisine_info
  
- rule: Hỏi ẩm thực (thiếu địa điểm)
  condition:
  - slot_was_set:
    - location: null # Nếu slot location chưa được set
  steps:
  - intent: ask_cuisine
  - action: utter_ask_for_location  # ✅ Sử dụng utter_ask_for_location

- rule: Người dùng cung cấp địa điểm sau khi bot hỏi
  condition:
  - active_loop: null # Rule này chỉ chạy khi không có form đang hoạt động
  steps:
  - intent: inform_location         # ✅ Sử dụng inform_location
  - action: action_query_knowledge_base
  - action: utter_cuisine_info
    # Lưu ý: Cần đảm bảo intent inform_location được dùng để điền slot 'location' 
    # trong domain.yml để action_query_knowledge_base có thể hoạt động.